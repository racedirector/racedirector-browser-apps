<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Wind</title>
	<meta name="author" content="Mihail Latyshov" />
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@600&display=swap&text=0123456789" rel="stylesheet">
	<style>html,body{height:100%}body{margin:0;overflow:hidden;color:var(--wind-color);pointer-events:none}svg{position:absolute;width:100%;height:100%;box-sizing:border-box;fill:none;stroke:currentColor;stroke-width:4;stroke-linecap:round;stroke-linejoin:round}svg > path{transform:rotate(calc(var(--wind-dir) * 1rad + 0.5turn));transform-origin:center;transform-box:fill-box}div{position:absolute;width:100%;height:100%;display:flex;justify-content:center;align-items:center;font-family:'JetBrains Mono',monospace;font-size:45vmin}</style>
</head>
<body>
	<svg xmlns="http://www.w3.org/2000/svg" viewBox="-2 -2 64 64">
		<path d="M50.0262 7.6624A29.9248 29.9248 90 0160 30c0 16.5685-13.4315 30-30 30S0 46.5685 0 30A29.9254 29.9254 90 0110.0078 7.632M21.5147 8.5 30 .0147 38.4853 8.5"/>
	</svg>
	<div>18</div>
	<script>(()=>{var t={745:(t,e,n)=>{var r,s=[].indexOf;r=n(165),t.exports=class extends r{constructor(){super(...arguments),this.emitter=new EventTarget,this.isTest=!1,this.emitApply=!1,this.proxyData={updatedKeys:new Set,old:{},data:{},watching:[]},this.proxy=new Proxy(this.proxyData,{set:function(t,e,n){return t.data[e]!==n&&(t.updatedKeys.add(e),t.data[e]=n),!0}}),this.onConnect=(t=!0)=>{if(this.proxy.connected=!0,t)return this.apply()},this.onDisconnect=(t=!0)=>{var e;for(e in this.proxy.connected=!1,t&&this.apply(),this.proxyData.updatedKeys.clear(),this.proxyData.old={},this.proxyData.data)delete this.proxyData.data[e];return this.proxyData.watching.forEach((function(t){return t.firstPass=!0}))},this.onUpdate=(t,e=!0,n=!1)=>{var r,s,i;if(!this.isTest||n){for(r=0,i=t.length;r<i;r++)s=t[r],this.proxy[s]=this.data[s];return e?this.apply():void 0}},this.onBroadcast=t=>this.emit("broadcast",t)}getData(){return this.proxyData.data}apply(){var t,e,n,r,i,a,o,c,h,d;for(this.applying=!0,d=this.proxyData.watching;d.length;){for(o=d.slice(0),e=0,i=d.length;e<i;e++)(h=d[e]).cancel||this.applyWatcher(h);d=d.filter((function(t){return s.call(o,t)<0}))}for(c=this.proxyData.watching.filter((function(t){return t.cancel})),r=0,a=c.length;r<a;r++)h=c[r],t=this.proxyData.watching.findIndex((function(t){return t===h})),this.proxyData.watching.splice(t,1);for(n of this.proxyData.updatedKeys)this.proxyData.old[n]=this.proxyData.data[n];if(this.proxyData.updatedKeys.clear(),this.applying=!1,this.emitApply)return this.emit("apply")}applyWatcher(t){var e,n,r,s,i,a,o,c;for(a=[],o=[],e=!1,n=r=0,i=(c=t.keys).length;r<i;n=++r)s=c[n],this.proxyData.updatedKeys.has(s)?(a[n]=this.proxyData.data[s],o[n]=this.proxyData.old[s],e=!0):a[n]=o[n]=this.proxyData.data[s];if(t.firstPass&&(t.firstPass=!1,e=a.some((function(t){return null!=t}))),e)return 1===a.length?t.callback(a[0],o[0]):t.callback(a,o)}watch(t,e){var n;return"string"==typeof t&&(t=[t]),this.proxyData.watching.push(n={keys:t,firstPass:!0,callback:e}),function(t){return t.cancel=!0}.bind(this,n)}emit(t,e){return this.emitter.dispatchEvent(new CustomEvent(t,{detail:e}))}}},165:(t,e,n)=>{t=n.nmd(t);var r,s=[].indexOf;r=class{constructor(t=[],e=[],n=1,r="127.0.0.1:8182",s=!1,i=null,a=null){this.requestParams=t,this.requestParamsOnce=e,this.fps=n,this.server=r,this.readIbt=s,this.record=i,this.zipLibPath=a,this.data={},this.onConnect=null,this.onDisconnect=null,this.onUpdate=null,this.onBroadcast=null,this.ws=null,this.onWSConnect=null,this.onWSDisconnect=null,this.reconnectTimeout=null,this.connected=!1,this.firstTimeConnect=!0,null!=this.record&&this.loadRecord(),this.connect()}connect(){return this.ws=new WebSocket(`ws://${this.server}/ws`),this.ws.onopen=(...t)=>this.onopen(...t),this.ws.onmessage=(...t)=>this.onmessage(...t),this.ws.onclose=(...t)=>this.onclose(...t)}close(){return this.ws.onclose=null,this.ws.close()}onopen(){var t;if("function"==typeof this.onWSConnect&&this.onWSConnect(),null!=this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),null==this.record){for(t in this.data)delete this.data[t];return this.ws.send(JSON.stringify({fps:this.fps,readIbt:this.readIbt,requestParams:this.requestParams,requestParamsOnce:this.requestParamsOnce}))}}onmessage(t){var e,n,r,s,i;if(e=JSON.parse(t.data),null==this.record){if(e.disconnected&&(this.connected=!1,"function"==typeof this.onDisconnect&&this.onDisconnect()),e.connected)for(n in this.data)delete this.data[n];if((e.connected||this.firstTimeConnect&&!this.connected&&!e.broadcast)&&(this.firstTimeConnect=!1,this.connected=!0,"function"==typeof this.onConnect&&this.onConnect()),e.data){for(n in r=[],s=e.data)i=s[n],r.push(n),this.data[n]=i;"function"==typeof this.onUpdate&&this.onUpdate(r)}}if(e.broadcast)return"function"==typeof this.onBroadcast?this.onBroadcast(e.broadcast):void 0}onclose(){return"function"==typeof this.onWSDisconnect&&this.onWSDisconnect(),this.ws&&(this.ws.onopen=this.ws.onmessage=this.ws.onclose=null),this.connected&&(this.connected=!1,null==this.record&&"function"==typeof this.onDisconnect&&this.onDisconnect()),this.reconnectTimeout=setTimeout((()=>this.connect.apply(this)),2e3)}sendCommand(t,...e){return this.ws.send(JSON.stringify({command:t,args:e}))}broadcast(t){return this.ws.send(JSON.stringify({broadcast:t}))}loadRecord(){var t,e;return t=this.zipLibPath&&-1!==this.record.search(/\.zip$/i),(e=new XMLHttpRequest).onreadystatechange=()=>{var n,r;if(4===e.readyState&&200===e.status)return t?(n=document.head,(r=document.createElement("script")).src=this.zipLibPath+"zip.js",n.appendChild(r),r.addEventListener("load",(()=>{var t;return zip.useWebWorkers=!1,(t=document.createElement("script")).src=this.zipLibPath+"inflate.js",n.appendChild(t),t.addEventListener("load",(()=>zip.createReader(new zip.BlobReader(e.response),(e=>e.getEntries((s=>s[0].getData(new zip.TextWriter,(s=>(e.close(),n.removeChild(t),n.removeChild(r),this.onRecord(JSON.parse(s)))))))))))}))):this.onRecord(e.response)},e.open("GET",this.record,!0),e.responseType=t?"blob":"json",e.send()}onRecord(t){return this.connected=!0,"connected"in t[0]||t.unshift({connected:!0}),this.record={frames:t,requestedParamsOnce:[]},"function"==typeof this.onConnect?this.onConnect():void 0}playRecord(t=0,e=null,n=1){var r;for(this.record.currentFrame=0,"function"==typeof this.onConnect&&this.onConnect(!1),r=t;r-- >=0;)this.record.currentFrame++,this.playRecordFrame(!1);return null!=this.record.playInterval&&clearInterval(this.record.playInterval),!n||null!=e&&t>=e?this.record.currentFrame<this.record.frames.length-1?setTimeout((()=>(this.record.currentFrame++,this.playRecordFrame())),1):void 0:this.record.playInterval=setInterval((()=>this.record.currentFrame<this.record.frames.length-1&&!(null!=e&&this.record.currentFrame>=e)?(this.record.currentFrame++,this.playRecordFrame()):clearInterval(this.record.playInterval)),1e3/n)}resetRecord(){return null!=this.record.playInterval&&clearInterval(this.record.playInterval),setTimeout((()=>{var t;for(t in this.record.requestedParamsOnce=[],this.data)delete this.data[t];return"function"==typeof this.onDisconnect&&this.onDisconnect(),setTimeout((()=>"function"==typeof this.onConnect?this.onConnect():void 0),500)}),100)}playRecordFrame(t=!0){var e,n,r,i,a;if(null!=(e=this.record.frames[this.record.currentFrame])?e.data:void 0){for(n in r=[],i=e.data)a=i[n],(s.call(this.requestParams,"__all_telemetry__")>=0||s.call(this.requestParams,n)>=0||s.call(this.requestParamsOnce,n)>=0&&s.call(this.record.requestedParamsOnce,n)<0)&&(r.push(n),this.data[n]=a,s.call(this.requestParamsOnce,n)>=0&&s.call(this.record.requestedParamsOnce,n)<0&&this.record.requestedParamsOnce.push(n));return"function"==typeof this.onUpdate?this.onUpdate(r,t):void 0}}},"undefined"!=typeof window&&null!==window&&(window.IRacing=r),null!=(null!==t?t.exports:void 0)&&(t.exports=r)}},e={};function n(r){var s=e[r];if(void 0!==s)return s.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r](i,i.exports,n),i.loaded=!0,i.exports}n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t,e,r,s,i,a,o,c,h,d,l,u;for(u of(t=n(745),s={},new URLSearchParams(location.search)))[h,l]=u,s[h]=/^\d{1,10}$/.test(l)?parseInt(l):l;c=new t(["WindDir","WindVel","YawNorth"],[],60,s.host||"127.0.0.1:8182",!1,void 0),o=c.getData(),document.querySelector("svg"),i=document.querySelector("div"),d=document.body.style,r=null,(e=new Image).addEventListener("load",(function(){var t,n;return(t=document.createElement("canvas")).width=this.width,t.height=this.height,(n=t.getContext("2d")).drawImage(this,0,0),e=n.getImageData(0,0,this.width,this.height).data,r=e.length/4,d.setProperty("--wind-color",a(18)),d.setProperty("--wind-dir",Math.PI)}),{once:!0}),e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA+gAAAABCAYAAABNAIQzAAAAAXNSR0IArs4c6QAAAeZJREFUWIWVVVF25DAIk2bbvt7/ju0ddrdj9SOOAxgzzkcmRghZECfDr+9vQQIAHL84w3Xcf3wsH+/oTLpKdHFTV5t+K13d6HsVa9PvvXnem83eLNb+tKw54zs93HkObobR77afsH8yi+rZ2HOw27vvwcwv0fF75b3XnFzH9u5qCAhEY+f1WEDAgEaO+sbsTrTObzbX1+m9r58AGoUnjvWTwA+AHwL/Afwl8O90Tph7xM7usrwu3lgvMKuVYVBYR84C21on8dBSUbObszGK3HW9Qfik8AHhvV9vFP7AXCZ+oB13Co+B9SvD0Ab+6Ccw8h9oyxx7bqrnXEOj5XMNTD1kGrG+5rysUd8/zITZeuLaXEv0mzkW6o9d/VjZD4fMkZU5IjJH8Pqw+FrPnV8LhTg52vF1CfjBY8HljAfsjFc1EMvc5YUeT2vofQe8qpm92pp6vyW+XZvwNvbTwDd9hZyKeUd/WvZxxXqho6JvLXRXPd7hZ76y+jiPeT59DtMe7g8STLCTR4uNWXg+E2zF5wutzEOaO+tU5FZ1qjQ36gNHN7j9q1hyldQcy3q/FGeOTxhzXzJ57y9wCn/iWtPvWWuNxxZmOOtffl39oMT6eb8Mi7PUhHn/mjCj7zyu/F29ZX7tc5DR/wVzsoITOAObTgAAAABJRU5ErkJggg==",c.watch(["WindDir","WindVel","YawNorth"],(function(){var t,e;if(t=o.WindDir-o.YawNorth,e=3.6*o.WindVel,!isNaN(t)&&!isNaN(e))return d.setProperty("--wind-color",a(e)),d.setProperty("--wind-dir",t),i.textContent=Math.round(e)})),a=function(t){var n,s;return s=4*Math.floor((r-1)*Math.max(0,Math.min(1,t/60))),`rgb(${function(){var t,r,i,a;for(a=[],n=t=r=s,i=s+2;r<=i?t<=i:t>=i;n=r<=i?++t:--t)a.push(e[n]);return a}().join(",")})`}})()})();</script>
</body>
</html>
